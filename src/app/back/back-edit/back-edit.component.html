<ul>
  <li>
    問卷標題：<input type="text" [(ngModel)]="quizData.name">
  </li>
  <li>
    問卷說明：<textarea [(ngModel)]="quizData.description"></textarea>
  </li>
  <li>
    開始時間：
    <input
      type="date"
      [(ngModel)]="quizData.startDate"
      [min]="today"
      (ngModelChange)="onStartDateChange($event)"
    >
    結束時間：
    <input
      type="date"
      [(ngModel)]="quizData.endDate"
      [min]="quizData.startDate || today"
      (ngModelChange)="onEndDateChange($event)"
    >
  </li>


  <li style="margin-top: 8px;">
    @for (ques of quizData.questionList; track $index; let qi = $index) {
      <ul style="margin-bottom: 16px;">
        <!-- <li>{{ ques.questionId }}. {{ ques.question }}</li> -->
        <li>{{ ques.questionId }}. <input type="text" [(ngModel)]="ques.question"></li>

        <li>題目類型：
          <select [(ngModel)]="ques.type" (ngModelChange)="ensureMinOptions(qi, $event)">
            <option value="SINGLE">單選題</option>
            <option value="MULTI">多選題</option>
            <option value="TEXT">文字輸入</option>
          </select>
        </li>

        <li>必填：
          <!-- 用一個 checkbox + 綁定就好 -->
          <input type="checkbox" [(ngModel)]="ques.required">
        </li>

        <li>
          @if (ques.type !== 'TEXT') {
            <div>
              選項：
              <ul>
                @for (option of ques.options; track $index; let i = $index) {
                  <li>
                    <input type="text" [(ngModel)]="ques.options[i]">
                    <button type="button" (click)="removeOption(qi, i)">Ｘ</button>
                  </li>
                }
              </ul>
              <button type="button" (click)="addOption(qi)">＋</button>
            </div>
          } @else {
            <div>
              文字內容：
              <textarea [(ngModel)]="ques.textAnswer"></textarea>
            </div>
          }
          <button type="button" (click)="removeQuestion(qi)">刪除此題</button>
        </li>
      </ul>
    }
  </li>
</ul>

<span>新增位置：</span>
<select [(ngModel)]="insertPos">
  @for (pos of [].constructor((quizData?.questionList?.length || 0) + 1); track $index; let i = $index) {
    <option [value]="i + 1">{{ i + 1 }}</option>
  }
</select>
<button type="button" (click)="addQuestionAt()">新增問題</button>

<br>
<br>

<!-- <button (click)="showData()">console</button> -->
<button routerLink="/back/backList">返回</button>
<button *ngIf="canShowRelease" type="button" (click)="release()">發布</button>
<button (click)="save()">
  {{ quizData?.published === false ? '儲存草稿' : '儲存變更' }}
</button>

